# NUpbr

This repository holds code to generate a configurable, Physically Based Rendered (PBR) football field.

See NUbook for a more detailed documentation of this project: <https://nubook.netlify.app/system/tools/nupbr>.

![Field Example](./docs/outputs/goals_example.gif)

# Requirements
+ [Blender](https://www.blender.org/download/) (2.79)

# Usage
## Generating field UV map
A UV map for the field can be generated by running [`generate_uv.py`](./field_uv/generate_uv.py). This will use the configuration listed in [`scene_config.py`](./pbr/config/scene_config.py).

## Building the scene
To generate the scene with default field UV map, the `pbr` script should be run through the Blender Python API. That is, `blender --python pbr.py` while in the pbr directory. This will create a scene, rendering a ball, goals and a field depending on the HDR metadata.

The ball UV map and HRDI environment image are randomly selected from the respective configured directory, within [`scene_config.py`](./pbr/config/scene_config.py).

To build only the goal, ball or field, run `blender --python <script>` where `<script>` is either `goal`, `ball` or `field` from the `pbr` directory.

## Custom Resources
The resources used for texturing the ball, field and environment by default are found in [`resources/ball_uv`](./resources/ball_uv), [`resources/field_uv`](./resources/field_uv) and [`resources/scene_hdr`](./resources/scene_hdr) respectively.  The directory to look for these resources can be modified in [`scene_config.py`](./pbr/config/scene_config.py) under `field_uv['uv_path']`, `ball['uv_path']` and `scene_hdr['path']`.

### Field
A new field UV map and construction can be configured in [`scene_config.py`](./pbr/config/scene_config.py) (by default saved in `<resources_dir>/field_uv`]).

### Ball
Custom UV maps to be considered for selection when generating the scene can be placed in the ball UV directory (by default `<resources>/balls`). 

### Environment
Similarly to the ball UV maps, a random HDRI environment image is selected from the pool of images within the scene HDR directory (by default `<resources>/scene_hdr`).
